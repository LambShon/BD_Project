# База данных "Фермерский кооператив"

made by Шонгуров Андрей
## Краткое описание
Эта база данных предназначена для автоматизации учета продукции, заказов и логистики в фермерском кооперативе. Она включает информацию о фермерах, продукции, складах, покупателях, заказах и их деталях. Основная цель — обеспечить прозрачность поставок, контроль остатков товаров и учет заказов, а также сохранять историю изменений ключевых данных, таких как цены на продукцию.
## Концептуальная модель
![Концептуальная модель](https://github.com/user-attachments/assets/ecb0428e-92ab-48d3-875d-d5a78c675ad8)
## Логическая модель
![Логическая модель](https://github.com/user-attachments/assets/bf50c28d-d047-45c5-b882-4fe1bab97f49)
## Описание таблиц
1. Фермеры (Farmers)
  Содержит информацию о поставщиках продукции:
    * `farmer_id` (PK) — уникальный ID фермера
    * `name` — ФИО фермера
    * `phone_number` — контактный телефон
    * `email` — электронная почта (опционально)
    * `farm_address` — адрес фермы

  Связи:
   Один фермер может поставлять несколько товаров (1:N с таблицей Продукция).
2. Склады (Warehouses)
  Содержит данные о местах хранения товаров:
    * `warehouse_id` (PK) — уникальный ID склада
    * `address` — адрес склада
    * `storage_type` — тип хранения (например, "холодильник", "сухое помещение")
    * `capacity` — вместимость склада (в единицах товара)

  Связи:
    - На одном складе может храниться несколько товаров (1:N с таблицей Продукция).
3. Продукция (Products)
  Содержит информацию о товарах, их характеристиках и наличии:
    * `product_id` (PK) — уникальный ID товара
    * `farmer_id` (FK → Farmers) — ID фермера-поставщика
    * `warehouse_id` (FK → Warehouses) — ID склада хранения
    * `name` — название товара
    * `category` — категория (например, "молочное", "овощи", "фрукты")
    * `current_price` — текущая цена за единицу
    * `quantity_in_stock` — количество товара на складе
    * `shelf_life` — срок годности

  Связи:
    - Каждый товар принадлежит одному фермеру и хранится на одном складе (N:1 с Farmers и Warehouses).
4. Покупатели (Customers)
  Содержит данные о клиентах, оформляющих заказы:
    * `customer_id` (PK) — уникальный ID покупателя
    * `name` — ФИО покупателя
    * `phone_number` — контактный телефон
    * `address` — адрес доставки

  Связи:
    - Один покупатель может оформить несколько заказов (1:N с таблицей Заказы).
5. Заказы (Orders)
  Содержит информацию о заказах покупателей:
    * `order_id` (PK) — уникальный ID заказа
    * `customer_id` (FK → Customers) — ID покупателя
    * `order_date` — дата и время оформления заказа
    * `status` — статус заказа ("новый", "в обработке", "доставлен", "отменен")
    * `total_amount` — общая сумма заказа

  Связи:
    - Каждый заказ принадлежит одному покупателю (N:1 с Customers).
    - Один заказ может включать несколько товаров (1:N с СоставЗаказа).
6. Состав заказа (OrderItems)
  Содержит детализацию заказанных товаров:
    * `order_item_id` (PK) — уникальный ID позиции в заказе
    * `order_id` (FK → Orders) — ID заказа
    * `product_id` (FK → Products) — ID товара
    * `quantity` — количество товара
    * `price_at_order_time` — цена товара на момент заказа (версионирование)

  Связи:
    - Каждая позиция связана с одним заказом и одним товаром (N:1 с Orders и Products).
    - Поле price_at_order_time фиксирует цену товара при оформлении заказа, даже если current_price изменится.

## Нормальная форма
База данных приведена к третьей нормальной форме (3NF).
  * 1NF (Первая нормальная форма):
    Все атрибуты атомарны (нет повторяющихся групп).
  * 2NF (Вторая нормальная форма):
    Нет частичных зависимостей от составного ключа (все таблицы имеют простой первичный ключ).
  * 3NF (Третья нормальная форма):
    Устранены транзитивные зависимости (неключевые атрибуты зависят только от первичного ключа).

Обоснование выбора 3NF:
  - Минимизирует избыточность (например, цена товара не дублируется в разных записях).
  - Упрощает обновления (изменение цены в Продукция не требует правки во всех заказах — актуальная цена берется из OrderItems.price_at_order_time).
  - Обеспечивает целостность данных, что критично для учета продукции и финансовых операций.
## Тип версионирования
Выбран тип версионирования 2 (Snapshot).
Реализация:
  Версионирование реализовано в таблице СоставЗаказа через поле price_at_order_time, которое фиксирует цену товара на момент оформления заказа.
Обоснование выбора версионирования типа 2 (Snapshot):
  1. Минимальные накладные расходы
    * Не требуется отдельная таблица для истории цен — достаточно одного поля в OrderItems.
    * Экономия места: хранится только релевантная информация (цена в заказе), а не все изменения.
  2. Упрощение запросов
    * Для формирования отчетов о продажах не нужно обращаться к истории — данные уже записаны в заказе.
  3. Соответствие бизнес-требованиям
    * В фермерском кооперативе критична финансовая отчетность, а не полный аудит изменений цен.
    * Если цена товара изменилась, это не влияет на уже завершенные заказы.
  4. Легкое масштабирование
    * Мы всегда можем легко добавить таблицу которая бы сохраняла изменения цен, без изменения существующей схемы
